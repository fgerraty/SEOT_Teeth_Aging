<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>index</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="precision-of-northern-sea-otter-aging-using-tooth-cementum-annuli-analysis" class="level1">
<h1>Precision of Northern Sea Otter Aging using Tooth Cementum Annuli Analysis</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>For the last couple years, we have submitted multiple teeth from the same individual sea otter carcasses to Matson’s labs to assess precision of aging via cementum annuli analysis. In this document, I outline preliminary results of this exploratory investigation.</p>
<p>We submitted teeth from four general tooth type categories: Molars, Premolars, Canines, Incisors. These teeth originated from two regions: Katmai National Park and Western Prince William Sound.</p>
<section id="sample-size-of-aged-teeth-by-predictor" class="level4">
<h4 class="anchored" data-anchor-id="sample-size-of-aged-teeth-by-predictor">Sample Size of Aged Teeth by Predictor</h4>
<table class="table">
<thead>
<tr class="header">
<th>Molars</th>
<th>Premolars</th>
<th>Canines</th>
<th>Incisors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>31</td>
<td>65</td>
<td>30</td>
<td>29</td>
</tr>
</tbody>
</table>
<table class="table">
<thead>
<tr class="header">
<th>Katmai National Park</th>
<th>Western Prince William Sound</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>120</td>
<td>39</td>
</tr>
</tbody>
</table>
<table class="table">
<thead>
<tr class="header">
<th>2006</th>
<th>2007</th>
<th>2008</th>
<th>2013</th>
<th>2019</th>
<th>2021</th>
<th>2022</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>6</td>
<td>6</td>
<td>6</td>
<td>23</td>
<td>22</td>
<td>94</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="data-import-and-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-import-and-cleaning">Data Import and Cleaning</h2>
<p>In the following code chunk, I import the raw dataset and undergo several cleaning steps including filtering out unknown tooth types, unsuccessfully aged teeth, and individuals with teeth aged in different years (i.e.&nbsp;recaptures).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 0: Load packages #######################</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>packages<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"readxl"</span>, <span class="st">"janitor"</span>, <span class="st">"lme4"</span>, <span class="st">"AICcmodavg"</span>, <span class="st">"viridis"</span>, <span class="st">"ggthemes"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(packages, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 1: Load raw dataset ####################</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>SEOT_teeth_raw <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/raw/SEOT_teeth_raw.xlsx"</span>))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2: Clean and summarize datasets ########</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2A: Categorize tooth types (premolars, canines, incisors, molars, or unknown) ----</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"P2a"</span>,<span class="st">"P2b"</span>,<span class="st">"P2"</span>,<span class="st">"Pa"</span>,<span class="st">"Pb"</span>,<span class="st">"P"</span>,<span class="st">"UP"</span>,<span class="st">"LLP2"</span>,<span class="st">"URP3"</span>,<span class="st">"URP2"</span>,<span class="st">"ULP3"</span>,<span class="st">"ULP2"</span>,<span class="st">"URP2 or ULP2"</span>,<span class="st">"P2, additional tooth sent in 2023"</span>,<span class="st">"LRP2"</span>,<span class="st">"URP4"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C"</span>,<span class="st">"URC"</span>,<span class="st">"LRC"</span>,<span class="st">"ULC"</span>,<span class="st">"ULC (BROKEN)"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"URI3"</span>,<span class="st">"URI1"</span>,<span class="st">"I3"</span>,<span class="st">"ULI3"</span>,<span class="st">"LLI2"</span>,<span class="st">"LLI1"</span>,<span class="st">"LRI2"</span>,<span class="st">"UI1?"</span>,<span class="st">"I2"</span>,<span class="st">"UI2"</span>,<span class="st">"LRI1"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"URM1"</span>,<span class="st">"LRM1"</span>,<span class="st">"ULM1"</span>,<span class="st">"M2"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>UNK <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"UNK"</span>, <span class="st">"UNKa"</span>, <span class="st">"UNKb"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2B: Generate clean, single-tooth dataset ----------------------------------------</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>SEOT_teeth <span class="ot">&lt;-</span> SEOT_teeth_raw <span class="sc">%&gt;%</span> </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove individuals with no teeth collected and/or no ages calculated due to tooth damage</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tooth_collected <span class="sc">==</span> <span class="st">"Y"</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>         otter_num <span class="sc">!=</span> <span class="st">"SOD-2021-200"</span>, <span class="co">#individual with tooth damage (couldnt be aged)</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>         otter_num <span class="sc">!=</span> <span class="st">"KEFJ-SOD-2014-01"</span>,<span class="co">#individual with certainty code missing</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>         otter_num <span class="sc">!=</span> <span class="st">"SOD-2006-17/ capture otter SO-05-04"</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>         otter_num <span class="sc">!=</span> <span class="st">"SOD-2007-02/capture otter SO-01-01"</span>, <span class="co">#teeth pulled different years</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>         otter_num <span class="sc">!=</span> <span class="st">"SOD-2007-01/ capture otter SO-04-24"</span>, <span class="co">#teeth pulled different years</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>         otter_num <span class="sc">!=</span> <span class="st">"WPWS-SOD-2014-02/ capture otter SO-2010-08"</span> <span class="co">#teeth pulled different years</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Categorize teeth to broad categories</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tooth_category =</span> </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>           <span class="co">#categorize all unknown teeth as "UNK"           </span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(tooth <span class="sc">%in%</span> UNK <span class="sc">~</span> <span class="st">"UNK"</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>                     tooth <span class="sc">%in%</span> C <span class="sc">~</span> <span class="st">"C"</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                     tooth <span class="sc">%in%</span> P <span class="sc">~</span> <span class="st">"P"</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                     tooth <span class="sc">%in%</span> I <span class="sc">~</span> <span class="st">"I"</span>,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                     tooth <span class="sc">%in%</span> M <span class="sc">~</span> <span class="st">"M"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">#keep only relevant columns</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, collection_date, </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">otter_id =</span> otter_num,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">tooth_id =</span> tooth_num, </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>         area, age, age_class, certainty_code, matson_min, matson_max, matson_notes, sex, tooth_category, latitude, longitude)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2C: Generate clean, 2-tooth dataset ----------------------------------------------</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>tooth_age_comparison <span class="ot">&lt;-</span> SEOT_teeth <span class="sc">%&gt;%</span> </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(otter_id, age, age_class, certainty_code, tooth_category) <span class="sc">%&gt;%</span> </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Group by otter ID and then create a new line for each combination of 2 teeth within the same otter</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(otter_id) <span class="sc">%&gt;%</span> </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">age =</span> <span class="fu">t</span>(<span class="fu">combn</span>(age, <span class="dv">2</span>)),</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">age_class =</span> <span class="fu">t</span>(<span class="fu">combn</span>(age_class, <span class="dv">2</span>)),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">certainty_code =</span> <span class="fu">t</span>(<span class="fu">combn</span>(certainty_code, <span class="dv">2</span>)),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">tooth_category =</span> <span class="fu">t</span>(<span class="fu">combn</span>(tooth_category, <span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Extract values from list objects</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age1 =</span> age[,<span class="dv">1</span>],</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">age2 =</span> age[,<span class="dv">2</span>],</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>         <span class="at">age_class1 =</span> age_class[,<span class="dv">1</span>],</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>         <span class="at">age_class2 =</span> age_class[,<span class="dv">2</span>],</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>         <span class="at">certainty_code1 =</span> certainty_code[,<span class="dv">1</span>],</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>         <span class="at">certainty_code2 =</span> certainty_code[,<span class="dv">2</span>],</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>         <span class="at">tooth_category1 =</span> tooth_category[,<span class="dv">1</span>],</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>         <span class="at">tooth_category2 =</span> tooth_category[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Remove listed objects (redundant)</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>age,<span class="sc">-</span>age_class,<span class="sc">-</span>certainty_code,<span class="sc">-</span>tooth_category) <span class="sc">%&gt;%</span> </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate binary (1/0) response of same age and age class values</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_agreement =</span> <span class="fu">if_else</span>(age1 <span class="sc">==</span> age2, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>         <span class="at">age_class_agreement =</span><span class="fu">if_else</span>(age_class1 <span class="sc">==</span> age_class2, <span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Generate certainty_code combinations </span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">certainty_code_combo =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"A"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"A"</span> <span class="sc">~</span> <span class="st">"AA"</span>,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"A"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">~</span> <span class="st">"AB"</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"A"</span> <span class="sc">~</span> <span class="st">"AB"</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"A"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">~</span> <span class="st">"AC"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"A"</span> <span class="sc">~</span> <span class="st">"AC"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">~</span> <span class="st">"BB"</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">~</span> <span class="st">"BC"</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">~</span> <span class="st">"BC"</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    certainty_code1 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">&amp;</span> certainty_code2 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">~</span> <span class="st">"CC"</span>,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Generate tooth_category combinations</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tooth_category_combo =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span> <span class="st">"MM"</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"P"</span> <span class="sc">~</span> <span class="st">"MP"</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">~</span> <span class="st">"MC"</span>,</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"I"</span> <span class="sc">~</span> <span class="st">"MI"</span>,</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"P"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span> <span class="st">"MP"</span>,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"P"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"P"</span> <span class="sc">~</span> <span class="st">"PP"</span>,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"P"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">~</span> <span class="st">"PC"</span>,</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"P"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"I"</span> <span class="sc">~</span> <span class="st">"PI"</span>,</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span> <span class="st">"MC"</span>,</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"P"</span> <span class="sc">~</span> <span class="st">"PC"</span>,</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">~</span> <span class="st">"CC"</span>,</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"I"</span> <span class="sc">~</span> <span class="st">"CI"</span>,</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"I"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span> <span class="st">"MI"</span>,</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"I"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"P"</span> <span class="sc">~</span> <span class="st">"PI"</span>,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"I"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">~</span> <span class="st">"CI"</span>,</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"I"</span> <span class="sc">&amp;</span> tooth_category2 <span class="sc">==</span> <span class="st">"I"</span> <span class="sc">~</span> <span class="st">"II"</span>,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    tooth_category1 <span class="sc">==</span> <span class="st">"UNK"</span> <span class="sc">|</span> tooth_category2 <span class="sc">==</span> <span class="st">"UNK"</span> <span class="sc">~</span> <span class="st">"UNK"</span>,</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">certainty_category =</span> <span class="fu">if_else</span>(certainty_code_combo <span class="sc">==</span> <span class="st">"AA"</span>, <span class="st">"High"</span>, <span class="st">"Low"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Bring predictors (year, region) into dataframe</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., <span class="fu">unique</span>(SEOT_teeth[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)]), <span class="at">by=</span><span class="st">"otter_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="assessing-drivers-of-aging-uncertainty" class="level2">
<h2 class="anchored" data-anchor-id="assessing-drivers-of-aging-uncertainty">Assessing Drivers of Aging Uncertainty</h2>
<p>In the cementum annuli aging process, individuals who age the teeth assign a certainty code that is used for assessing the reliability of the age for a given tooth. The certainty codes are:</p>
<p><strong>A = High:</strong> Reliability ages indicate that the cementum characteristics of the tooth section very nearly match those of the standardized cementum aging model for the species and tooth type. Most certain, within +/- 1 year of reported toothage.</p>
<p><strong>B = Medium:</strong> There is histological evidence to support the result, and the correct age is expected to be within the range given in the “Notes” field. Usually age within +/- 2 years of reported tooth age.</p>
<p><strong>C = Low:</strong> Those for which the match between histological evidence and the standardized model is poor. Error is likely, and may occur within the range given.</p>
<section id="how-do-the-levels-of-uncertainty-break-down-by-our-various-predictors" class="level4">
<h4 class="anchored" data-anchor-id="how-do-the-levels-of-uncertainty-break-down-by-our-various-predictors">How do the levels of uncertainty break down by our various predictors?</h4>
<ol type="1">
<li><strong>Tooth Type</strong></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2: Uncertainty by Different Variables ##################################</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span> <span class="ot">=</span> <span class="st">"#0072b2"</span>, <span class="st">"B"</span> <span class="ot">=</span> <span class="st">"#009e73"</span>, <span class="st">"C"</span> <span class="ot">=</span> <span class="st">"#d55e00"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncertainty by tooth type plot and table ------------------------------------</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>tooth_type <span class="ot">&lt;-</span> SEOT_teeth <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tooth_category, certainty_code) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> n<span class="sc">/</span><span class="fu">sum</span>(n), <span class="co">#calculate frequency of each uncertainty level</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">tooth_category =</span> <span class="fu">factor</span>(tooth_category, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"P"</span>, <span class="st">"C"</span>, <span class="st">"I"</span>)),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">certainty_code =</span> <span class="fu">factor</span>(certainty_code, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>)),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_category =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tooth_category <span class="sc">!=</span> <span class="st">"UNK"</span>) <span class="co">#remove unknown teeth</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tooth_type, <span class="fu">aes</span>(<span class="at">x=</span>tooth_category, <span class="at">y=</span>freq))<span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>certainty_code), <span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A (low)"</span>, <span class="st">"B (medium)"</span>, <span class="st">"C (high)"</span>))<span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Frequency of Uncertainty Level"</span>, <span class="at">x=</span><span class="st">"Tooth Type"</span>, <span class="at">fill =</span> <span class="st">"Uncertainty Level"</span>)<span class="sc">+</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(n), <span class="at">group =</span> certainty_code), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Molar"</span>, <span class="st">"Premolar"</span>, <span class="st">"Canine"</span>, <span class="st">"Incisor"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="2" type="1">
<li><p><strong>Area</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Uncertainty by area ----------------------------------------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span> SEOT_teeth <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(area, certainty_code) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_area =</span> <span class="fu">sum</span>(n),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">certainty_code =</span> <span class="fu">factor</span>(certainty_code, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>))) <span class="sc">%&gt;%</span>  </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(area, <span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>freq))<span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>certainty_code), <span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A (low)"</span>, <span class="st">"B (medium)"</span>, <span class="st">"C (high)"</span>))<span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(n), <span class="at">group =</span> certainty_code), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Frequency of Uncertainty Level"</span>, <span class="at">x=</span><span class="st">"Region"</span>, <span class="at">fill =</span> <span class="st">"Uncertainty Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p><strong>Year</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Uncertainty by year ----------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> SEOT_teeth <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, certainty_code) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">as.character</span>(year),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">certainty_code =</span> <span class="fu">factor</span>(certainty_code, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(year, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>freq))<span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>certainty_code), <span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A (low)"</span>, <span class="st">"B (medium)"</span>, <span class="st">"C (high)"</span>))<span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(n), <span class="at">group =</span> certainty_code), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Frequency of Uncertainty Level"</span>, <span class="at">x=</span><span class="st">"Year"</span>, <span class="at">fill =</span> <span class="st">"Uncertainty Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
</ol>
</section>
</section>
<section id="assessing-drivers-of-aging-precision" class="level2">
<h2 class="anchored" data-anchor-id="assessing-drivers-of-aging-precision">Assessing Drivers of Aging Precision</h2>
<p>We measured precision in two ways:</p>
<ul>
<li><p>probability that teeth from the same otter were given the same age via tooth cementum annuli analysis.</p></li>
<li><p>probability that teeth from the same otter were given the same age class.</p></li>
</ul>
<section id="how-does-precision-break-down-by-predictor" class="level3">
<h3 class="anchored" data-anchor-id="how-does-precision-break-down-by-predictor">How Does Precision Break Down by Predictor?</h3>
<ol type="1">
<li><strong>Tooth Aging Certainty Score</strong></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2: Precision by Different Variables ####################################</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>tooth_comparison_certainty_summary <span class="ot">&lt;-</span> tooth_age_comparison <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(certainty_code_combo) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_age_agreement =</span> <span class="fu">sum</span>(age_agreement),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_age_class_agreement =</span> <span class="fu">sum</span>(age_class_agreement)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">"row"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(n_age_agreement, n_age_class_agreement))<span class="sc">%&gt;%</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq=</span> value<span class="sc">/</span>n)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>fct_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"n_age_agreement"</span> <span class="ot">=</span> <span class="st">"Frequency Age Agreement"</span>, <span class="st">"n_age_class_agreement"</span> <span class="ot">=</span> <span class="st">"Frequency Age Class Agreement"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tooth_comparison_certainty_summary, <span class="fu">aes</span>(certainty_code_combo, freq, <span class="at">fill =</span> certainty_code_combo, <span class="at">label =</span> <span class="fu">paste</span>(value, <span class="st">"/"</span>, n)))<span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="st">"name"</span>, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">switch=</span><span class="st">"y"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(fct_labels))<span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)))<span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Certainty Code </span><span class="sc">\n</span><span class="st">Combination"</span>)<span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.placement.y =</span> <span class="st">"outside"</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="2" type="1">
<li><strong>Tooth Type Combinations</strong></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tooth Type Combination ------------------------------------------------------</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>tooth_combo_certainty <span class="ot">&lt;-</span> tooth_age_comparison <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tooth_category_combo) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_age_agreement =</span> <span class="fu">sum</span>(age_agreement),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_age_class_agreement =</span> <span class="fu">sum</span>(age_class_agreement)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tooth_category_combo =</span> <span class="fu">factor</span>(tooth_category_combo, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"MP"</span>,<span class="st">"MC"</span>,<span class="st">"MI"</span>,<span class="st">"PP"</span>,<span class="st">"PC"</span>,<span class="st">"PI"</span>,<span class="st">"CI"</span>,<span class="st">"UNK"</span>))) <span class="sc">%&gt;%</span>  </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tooth_category_combo <span class="sc">!=</span> <span class="st">"UNK"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">"row"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(n_age_agreement, n_age_class_agreement))<span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq=</span> value<span class="sc">/</span>n)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tooth_combo_certainty, <span class="fu">aes</span>(tooth_category_combo, freq, <span class="at">fill =</span> tooth_category_combo, <span class="at">label =</span> <span class="fu">paste</span>(value, <span class="st">"/"</span>, n)))<span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="st">"name"</span>, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">switch=</span><span class="st">"y"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(fct_labels))<span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)))<span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Tooth Type </span><span class="sc">\n</span><span class="st">Combination"</span>)<span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.placement.y =</span> <span class="st">"outside"</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="3" type="1">
<li><strong>Area</strong></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>area_certainty <span class="ot">&lt;-</span> tooth_age_comparison <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(area) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_age_agreement =</span> <span class="fu">sum</span>(age_agreement),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_age_class_agreement =</span> <span class="fu">sum</span>(age_class_agreement)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">"row"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">factor</span>(area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"KATM"</span>, <span class="st">"WPWS"</span>, <span class="st">"Total"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(n_age_agreement, n_age_class_agreement))<span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq=</span> value<span class="sc">/</span>n)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(area_certainty, <span class="fu">aes</span>(area, freq, <span class="at">fill =</span> area, <span class="at">label =</span> <span class="fu">paste</span>(value, <span class="st">"/"</span>, n)))<span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="st">"name"</span>, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">switch=</span><span class="st">"y"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(fct_labels))<span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)))<span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Area"</span>)<span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.placement.y =</span> <span class="st">"outside"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li><strong>Year</strong></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Year ------------------------------------------------------</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>year_certainty <span class="ot">&lt;-</span> tooth_age_comparison <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_age_agreement =</span> <span class="fu">sum</span>(age_agreement),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_age_class_agreement =</span> <span class="fu">sum</span>(age_class_agreement)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">"row"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(n_age_agreement, n_age_class_agreement))<span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq=</span> value<span class="sc">/</span>n)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(year_certainty, <span class="fu">aes</span>(year, freq, <span class="at">fill =</span> year, <span class="at">label =</span> <span class="fu">paste</span>(value, <span class="st">"/"</span>, n)))<span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="st">"name"</span>, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">switch=</span><span class="st">"y"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(fct_labels))<span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)))<span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Year"</span>)<span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.placement.y =</span> <span class="st">"outside"</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modeling-drivers-of-precision" class="level3">
<h3 class="anchored" data-anchor-id="modeling-drivers-of-precision">Modeling Drivers of Precision</h3>
<p>Unfortunately, due to small sample sizes, perhaps coding errors, and the fact that the drivers of aging precision are not super apparent, none of the models I have generated to date have had significant predictor effects. Here is some of what I have tried:</p>
<p><strong>Age Agreement</strong></p>
<p>Assessinfg predictors of age agreement using mixed-effects logistic regression (binomial distribution, logit link) with otter_id as a random effect.</p>
<ul>
<li>Generate Models</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> tooth_age_comparison <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter(certainty_code_combo == "AA"|</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           certainty_code_combo == "AB"|</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#           certainty_code_combo == "BB") %&gt;% </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tooth_category_combo <span class="sc">!=</span> <span class="st">"UNK"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="st">"2019"</span> <span class="sc">|</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>           year <span class="sc">==</span> <span class="st">"2021"</span> <span class="sc">|</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>           year <span class="sc">==</span> <span class="st">"2022"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.character</span>(year))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for correlations among predictors ---------------------------------------</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(temp<span class="sc">$</span>certainty_category, temp<span class="sc">$</span>tooth_category_combo, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(temp<span class="sc">$</span>certainty_category, temp<span class="sc">$</span>area, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(temp<span class="sc">$</span>certainty_category, temp<span class="sc">$</span>year, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(temp<span class="sc">$</span>tooth_category_combo, temp<span class="sc">$</span>area, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(temp<span class="sc">$</span>tooth_category_combo, temp<span class="sc">$</span>year, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(temp<span class="sc">$</span>area, temp<span class="sc">$</span>year, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#As we can tell, "area" and "year" are significantly correlated, and "tooth_category_combo" and "year are significantly correlated</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Generate models with non-colinear predictors ----------------------------------</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_agreement <span class="sc">~</span> certainty_category <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp);<span class="fu">summary</span>(f1)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_agreement <span class="sc">~</span> tooth_category_combo <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(f2)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_agreement <span class="sc">~</span> area <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(f3)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_agreement <span class="sc">~</span> year <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(f4)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>f5 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_agreement <span class="sc">~</span> certainty_category <span class="sc">+</span> area <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(f5)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>f6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_agreement <span class="sc">~</span> certainty_category <span class="sc">+</span> year <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(f6)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>null <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_agreement <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(null)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#These models threw errors! </span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#f5 &lt;- glmer(age_agreement ~ certainty_category + tooth_category_combo + (1 | otter_id), family = binomial, data = temp); summary(f5)</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#f8 &lt;- glmer(age_agreement ~ tooth_category_combo + area + (1 | otter_id), family = binomial, data = temp); summary(f8)</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#f11 &lt;- glmer(age_agreement ~ certainty_category + tooth_category_combo + area + (1 | otter_id), family = binomial, data = temp); summary(f11)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Compare models using AICc</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cand.mod.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"f1"</span>, <span class="st">"f2"</span>, <span class="st">"f3"</span>, <span class="st">"f4"</span>, <span class="st">"f5"</span>, <span class="st">"f6"</span>, <span class="st">"null"</span>) </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cand.mods <span class="ot">&lt;-</span> <span class="fu">list</span>( ) </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This function fills the list by model names</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cand.mod.names)) {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  cand.mods[[i]] <span class="ot">&lt;-</span> <span class="fu">get</span>(cand.mod.names[i]) }</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Function aictab does the AICc-based model comparison</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">aictab</span>(<span class="at">cand.set =</span> cand.mods, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">modnames =</span> cand.mod.names))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

     K   AICc Delta_AICc AICcWt Cum.Wt     LL
null 2 187.18       0.00   0.36   0.36 -91.55
f3   3 187.79       0.61   0.27   0.63 -90.82
f1   3 188.92       1.74   0.15   0.78 -91.39
f5   4 189.56       2.38   0.11   0.89 -90.66
f4   4 190.52       3.34   0.07   0.96 -91.14
f6   5 192.39       5.20   0.03   0.99 -91.00
f2   8 194.26       7.08   0.01   1.00 -88.67</code></pre>
</div>
</div>
<p><strong>Age Class Agreement</strong></p>
<ul>
<li><p>Generate Models</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Generate models with non-colinear predictors</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_class_agreement <span class="sc">~</span> certainty_category <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp);<span class="fu">summary</span>(g1)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_class_agreement <span class="sc">~</span> tooth_category_combo <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(g2)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_class_agreement <span class="sc">~</span> area <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(g3)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_class_agreement <span class="sc">~</span> year <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(g4)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>g5 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_class_agreement <span class="sc">~</span> certainty_category <span class="sc">+</span> area <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(g5)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>g6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_class_agreement <span class="sc">~</span> certainty_category <span class="sc">+</span> year <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(g6)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>null <span class="ot">&lt;-</span> <span class="fu">glmer</span>(age_class_agreement <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> otter_id), <span class="at">family =</span> binomial, <span class="at">data =</span> temp); <span class="fu">summary</span>(null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
</ul>
<!-- -->
<ul>
<li>Compare models using AICc</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cand.mod.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"g1"</span>, <span class="st">"g2"</span>, <span class="st">"g3"</span>, <span class="st">"g4"</span>, <span class="st">"g5"</span>, <span class="st">"g6"</span>, <span class="st">"null"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cand.mods <span class="ot">&lt;-</span> <span class="fu">list</span>( ) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This function fills the list by model names</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cand.mod.names)) {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  cand.mods[[i]] <span class="ot">&lt;-</span> <span class="fu">get</span>(cand.mod.names[i]) }</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Function aictab does the AICc-based model comparison</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">aictab</span>(<span class="at">cand.set =</span> cand.mods, </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">modnames =</span> cand.mod.names))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

     K   AICc Delta_AICc AICcWt Cum.Wt     LL
g1   3 182.96       0.00   0.24   0.24 -88.41
g5   4 182.97       0.01   0.24   0.49 -87.36
null 2 183.26       0.30   0.21   0.70 -89.59
g3   3 183.41       0.45   0.20   0.89 -88.63
g6   5 186.05       3.08   0.05   0.95 -87.83
g4   4 186.11       3.14   0.05   1.00 -88.93
g2   8 191.05       8.09   0.00   1.00 -87.06</code></pre>
</div>
</div>
<p>These outputs suggest that none of the predictors performed significantly better than a null model. ….not exactly sure where to go from here.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>